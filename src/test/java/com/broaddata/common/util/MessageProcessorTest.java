/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.broaddata.common.util;

import com.broaddata.common.thrift.dataservice.DataService;
import com.broaddata.common.thrift.dataservice.DataobjectInfo;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
import static org.junit.Assert.*;
import org.junit.Ignore;

/**
 *
 * @author edf
 */
public class MessageProcessorTest {
    
    public MessageProcessorTest() {
    }
    
    @BeforeClass
    public static void setUpClass() {
    }
    
    @AfterClass
    public static void tearDownClass() {
    }
    
    @Before
    public void setUp() {
    }
    
    @After
    public void tearDown() {
    }

    /**
     * Test of execute method, of class MessageProcessor.
     */
 @Ignore
    @Test
    public void testExecute() throws Exception 
    {
        int organizationId = 100;
        int repositoryId = 1;
        int sourceApplicationId = 1;
        int clientNodeId = 1;
        DataServiceConnector dsConn;
        DataService.Client dataService;
        
        try
        {
            //dsConn = new DataServiceConnector();

            //dataService = dsConn.getClient("127.0.0.1");

            String lastProcessedMessage = "{\"table\":\"OGGTOPIC.ORDER_VPRD_DELIVERY\",\"op_type\":\"U\",\"op_ts\":\"2016-12-02 09:25:45.925857\",\"current_ts\":\"2016-12-02T17:25:47.407000\",\"pos\":\"00000000160041566359\",\"before\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21677\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21674},\"after\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21678\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21675}}";

        String val = lastProcessedMessage.substring(0,lastProcessedMessage.indexOf("current_ts")-3);
        val = val.substring(val.indexOf("op_ts")+8);
        
        
        
         /*   BlockingQueue<String> messageQueue = new ArrayBlockingQueue<>(1000000);

            // String message = "{\"organization_id\":100,\"repository_id\",3,\"source_application_id\":1,\"database_name\":\"ULE_ODS\",\"table_name\":\"USER_LOG\",\"columns\":[{\"column1\":\"value1\"},{\"column2\":\"value2\"}]}";
            //String message = "{\"TMP_VILLAGE_LEVEL_INVOICING.ULE_DM\":{\"VILLAGE_NO\":\"97215954\",\"R\":\"AAFPLhAIaAAAZpGAD9\",\"INVOICING_ORDER_AMT\":\"50\",\"INVOICING_ORDER_CNT\":\"1\"}}";
            //String message = "{\"jf_job.testdb\":{\"id\":\"97215954\",\"title\":\"AAFPLhAIaAAAZpGAD9\",\"state\":\"50\",\"is_del\":\"1\"}}";
            //messageQueue.put(message);

            message = "{\"jf_job.testdb\":{\"id\":\"97215954\",\"title\":\"AAFPLhAIaAAAZpGAD9\",\"state\":\"50\",\"is_del\":\"1\"}}";
            //messageQueue.put(message);

            */

            //String message = "{\"table\":\"OGGTOPIC.ORDER_VPRD_DELIVERY\",\"op_type\":\"U\",\"op_ts\":\"2016-12-02 09:25:45.925857\",\"current_ts\":\"2016-12-02T17:25:47.407000\",\"pos\":\"00000000160041566359\",\"before\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21677\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21674},\"after\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21678\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21675}}";

            //String message = "{\"table\":\"OGGTOPIC.ORDER_VPRD_DELIVERY\",\"op_type\":\"U\",\"op_ts\":\"2016-12-02 09:25:45.925857\",\"current_ts\":\"2016-12-02T17:25:47.407000\",\"pos\":\"00000000160041566359\",\""
            //        + "before\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21677\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21674},\""
            //        + "after\":{\"ID\":\"1900368257\",\"ESC_ORDERID\":\"9020160914378087\",\"ORDER_ID\":\"100378087\",\"DELEVERY_ORDER_ID\":null,\"ITEM_ID\":null,\"USR_ONLYID\":\"10000022084\",\"EMAIL\":\"æ¹˜æ½­\",\"MOBILE\":\"13975217909\",\"AMOUNT\":\"10\",\"REF_RESOURCES\":\"41000103\",\"TYPE\":5,\"SUB_TYPE\":723,\"STATUS\":99,\"DESC1\":\"æ¹–å?—\",\"DESC2\":\"ç§»åŠ¨\",\"DESC3\":\"postalHunan\",\"DESC4\":null,\"REMARK\":\"9999:merchantlink server status[503] error!\",\"CREATE_TIME\":\"2016-09-14:14:10:23\",\"CREATE_USER\":null,\"UPDATE_TIME\":\"2016-09-14:14:20:37\",\"UPDATE_USER\":null,\"VERSION\":\"21678\",\"CHARGE_SUCCESS_AMT\":\"0\",\"PARENT_ID\":null,\"QUERY_TIMES\":21675}}";

            //String message = "{\"table\":\"OGGTOPIC.new_core_bdfmhqab\",\"op_type\":\"I\",\"op_ts\":\"2016-12-06 02:04:14.980614\",\"current_ts\":\"2016-12-06T10:04:16.354001\",\"pos\":\"00000000160056477278\",\"after\":{\"ORDER_ID\":\"100391497\",\"ESC_ORDERID\":\"9020161206391497\",\"SELLER_ONLYID\":\"1200002\",\"SELLER_LOGINID\":\"���������������������������\",\"BUYER_ONLYID\":\"663\",\"BUYER_LOGINID\":\"���������������\",\"PRODUCT_SERIAL\":null,\"PRODUCT_ID\":null,\"PRODUCT_VERSION\":1,\"PRODUCT_CLASSID\":\"1\",\"PRODUCT_INFO\":\"������\",\"PRODUCT_PIC\":\"99887766\",\"PRODUCT_PRICE\":\"1\",\"PRODUCT_NUM\":null,\"PRODUCT_AMOUNT\":\"1\",\"PRODUCT_POINT_STATUS\":null,\"PRODUCT_COUPON_STATUS\":null,\"TRADE_DESC\":null,\"TRANS_TYPE1_VALUE\":null,\"TRANS_TYPE1_ADDVALUE\":null,\"TRANS_TYPE1_AMOUNT\":null,\"TRANS_TYPE2_VALUE\":null,\"TRANS_TYPE2_ADDVALUE\":null,\"TRANS_TYPE2_AMOUNT\":null,\"TRANS_TYPE3_VALUE\":null,\"TRANS_TYPE3_ADDVALUE\":null,\"TRANS_TYPE3_AMOUNT\":null,\"TRANS_TYPE4_VALUE\":null,\"TRANS_TYPE4_ADDVALUE\":null,\"TRANS_TYPE4_AMOUNT\":null,\"TRANS_TYPE5_VALUE\":null,\"TRANS_TYPE5_ADDVALUE\":null,\"TRANS_TYPE5_AMOUNT\":null,\"TRANS_TYPE6_VALUE\":null,\"TRANS_TYPE6_ADDVALUE\":null,\"TRANS_TYPE6_AMOUNT\":null,\"TRANS_TYPE7_VALUE\":null,\"TRANS_TYPE7_ADDVALUE\":null,\"TRANS_TYPE7_AMOUNT\":null,\"SALE_TYPE\":null,\"BUY_TYPE\":null,\"COUPON_ID\":null,\"COUPON_AMOUNT\":null,\"COUPON_USE_TIME\":null,\"TRANS_TYPE\":null,\"TRANS_SUBTYPE\":null,\"TRANS_CONTACT\":null,\"TRANS_INFO\":null,\"TRANS_ADDRESS\":null,\"TRANS_POSTAL_CODE\":null,\"TRANS_COUNTRY\":null,\"TRANS_PROVINCE\":\"������\",\"TRANS_CITY\":\"���������\",\"TRANS_USR_NAME\":null,\"TRANS_USR_PHONE\":null,\"TRANS_AMOUNT\":null,\"REBATE_AMOUNT\":null,\"GROUPBUY_AMOUNT\":null,\"ORDER_AMOUNT\":\"1\",\"PAYMENT_AMOUNT\":\"0\",\"REFUND_AMOUNT\":null,\"RELEASE_AMOUNT\":null,\"ORDER_PAYMENTID\":null,\"ORDER_REFUNDID\":null,\"ORDER_CREATE_TIME\":\"2016-12-06:10:04:14\",\"BANKPAY_ACTIVE_TIME\":null,\"POSTPAY_ACTIVE_TIME\":null,\"SELLER_MODIFY_TIME\":null,\"BUYER_MODIFY_TIME\":null,\"BUYER_REQUEST_TIME\":null,\"SELLER_RESPOND_TIME\":null,\"BUYER_PAY_TIME\":null,\"BUYER_RELEASE_TIME\":null,\"SELLER_SHIP_TIME\":null,\"ORDER_TERMINAL_TIME\":null,\"ORDER_ACTIVE_TIME\":null,\"BUYER_REFUND_TIME\":null,\"REFUND_ACTIVE_TIME\":null,\"ORDER_DELETED\":null,\"BUYER_FEEDBACK\":null,\"BUYER_FEEDBACK_TIME\":null,\"SELLER_FEEDBACK\":null,\"SELLER_FEEDBACK_TIME\":null,\"ORDER_STATUS\":3,\"ORDER_SUBSTATUS\":0,\"BUYER_NOTE\":null,\"BUYER_NOTE_TIME\":null,\"SELLER_NOTE\":null,\"SELLER_NOTE_TIME\":null,\"CANCEL_TYPE\":null,\"CANCEL_NOTE\":null,\"CANCEL_TIME\":null,\"REQUEST_CS_STATUS\":null,\"REQUEST_CS_TIME\":null,\"FREEZE_STATUS\":null,\"FREEZE_START_TIME\":null,\"FREEZE_CANCEL_TIME\":null,\"PAYMENT_NOTIFY_EMAIL\":null,\"PAYMENT_CLOSE_EMAIL\":null,\"SHIPITEM_NOTIFY_EMAIL\":null,\"RELEASE_NOTIFY_EMAIL1\":null,\"RELEASE_NOTIFY_EMAIL2\":null,\"RELEASE_NOTIFY_EMAIL3\":null,\"UPDATE_TIME\":\"2016-12-06:10:04:14\",\"CREATE_SP_ID\":null,\"BUYER_IP_ADDR\":\"180.169.59.210\",\"BUYER_HD_ID\":null,\"BUYER_CPU_ID\":null,\"BUYER_MAC_ID\":null,\"BUYER_COOKIE_INFO\":null,\"SELLER_IP_ADDR\":null,\"SELLER_HD_ID\":null,\"SELLER_CPU_ID\":null,\"SELLER_MAC_ID\":null,\"SELLER_COOKIE_INFO\":null,\"TRANS_WEBSITE\":null,\"BUYER_NOTE2\":null,\"BUYER_NOTE2_TIME\":null,\"SELLER_NOTE2\":null,\"SELLER_NOTE2_TIME\":null,\"FEEDBACK_INVOKE_STATUS\":null,\"POINT_INVOKE_STATUS\":null,\"MERCHANT_ORDER\":null,\"MERCHANT_USR_NAME\":null,\"MERCHANT_USR_EMAIL\":null,\"MERCHANT_BACKURL\":\"http://checkout.beta.ule.com/simpleorder/jiaofei/donatesuccess.do?escOrderId=9020161206391497&orderType=5002\",\"MERCHANT_DATE\":null,\"MERCHANT_RESPOND_STATUS\":null,\"CHARGES_AMOUNT\":null,\"SEARCH_SITE\":null,\"PRD_CATEGORY\":null,\"PRD_ITEM_ID\":\"1102\",\"PRD_CURRENCY\":\"1\",\"PRD_SAL_PRICE\":null,\"PRD_SAL_SHIPPING_FEE\":null,\"PARTNER_STATUS\":null,\"PARTNER_CONFIRM_TIME\":null,\"PARTNER_CONFIRM_NOTE\":null,\"PARTNER_PURCHASE_TIME\":null,\"PARTNER_PURCHASE_NOTE\":null,\"PARTNER_SHIPPING_TIME\":null,\"PARTNER_SHIPPING_NOTE\":null,\"INVOICE_TITLE\":null,\"INVOICE_CONTENT\":null,\"ORDER_TYPE\":\"5002\",\"CHECKOUT_MERCHANT_PRIVS_ID\":null,\"MERCHANT_ID\":null,\"INVOICE_IN_USE\":null,\"DELIVER_TIME\":null,\"DELIVER_CONFIM_FLAG\":null,\"POSTOFFICE_ID\":null,\"POSTOFFICE_NAME\":null,\"PAYED_AMOUNT\":null,\"AREA\":null,\"TEL_NUMBER\":null,\"TEL_AREA_CODE\":null,\"COST_PRICE\":null,\"REFER_TRANS_AMOUNT\":null,\"ACTUAL_TRANS_AMOUNT\":null,\"USEDPOINT\":null,\"USEDPOINTTYPE\":null,\"COUPONTYPE\":null,\"USEDPOINTAMOUNT\":null,\"RESERVE_FLAG\":null,\"PAYMENT_START_TIME\":null,\"POINT_NAME\":null,\"POINT_WEBSITE\":null,\"REMARK\":null,\"EXTRA_RECEIVE_INVOICE\":null,\"INVOICE_NAME\":null,\"INVOICE_TEL\":null,\"INVOICE_MOBILE\":null,\"INVOICE_ADDRESS\":null,\"INVOICE_POSTCODE\":null,\"BUYER_NAME\":null,\"BUYER_PHONE\":null,\"BUYER_MOBILE\":null,\"BUYER_EMAIL\":null,\"BUYER_POST_CODE\":null,\"BUYER_ADDRESS\":null,\"TRANS_PROVINCE_CODE\":\"310000\",\"TRANS_CITY_CODE\":\"310100\",\"AREA_CODE\":null,\"PROMOTION_TICKET\":null,\"SUPPORTED_BUYTYPE\":\"9_9:9_10:9_11:40_41:5_54\",\"DISCOUNT_AMOUNT\":null,\"PAYMENT_DUE_DATE\":null,\"CARD_CASH_PAY\":null,\"INVOICE_REQUIRED\":null,\"INVOICE_TYPE2\":null,\"INVOICE_BY_DETAIL\":null,\"INVOICE_TAX_COMPANY\":null,\"INVOICE_TAX_REG_NO\":null,\"INVOICE_TAX_REG_ADDR\":null,\"INVOICE_TAX_REG_TEL\":null,\"INVOICE_TAX_REG_BANK\":null,\"INVOICE_TAX_REG_ACC\":null,\"INVOICE_ISSUE_STATUS\":null,\"INVOICE_REISSUE_TIMES\":null,\"INVOICE_REISSUE_TIME\":null,\"INVOICE_DUP_ISSUE_TIMES\":null,\"INVOICE_DUP_ISSUE_TIME\":null,\"INVOICE_STATUS_LOCKED\":null,\"INVOICE_STATUS_LOCKED_TIME\":null,\"INVOICE_TYPE\":null,\"INVOICE_POST_TYPE\":null,\"SERVICE_FEE\":null,\"UPDATE_BY\":null,\"BUY_SUBTYPE\":null,\"CHANNEL\":\"ONLINE\",\"LIST_NUMBER\":null,\"SALES_CHANNEL\":\"101\",\"SELLER_NOTE3\":\"���������������������\",\"SELLER_NOTE4\":\"46967\",\"SELLER_NOTE5\":null,\"SELLER_NOTE6\":null,\"ID\":null,\"ORDER_POINT\":null,\"UNIQUE_KEY\":null,\"SETTLEMENT_FLAG\":null,\"BUYER_PROVINCE\":null,\"BUYER_PROVINCE_CODE\":null,\"BUYER_CITY\":null,\"BUYER_CITY_CODE\":null,\"BUYER_AREA\":null,\"BUYER_AREA_CODE\":null,\"SELLER_PROVINCE\":null,\"SELLER_PROVINCE_CODE\":null,\"SELLER_CITY\":null,\"SELLER_CITY_CODE\":null,\"SELLER_AREA\":null,\"SELLER_AREA_CODE\":null,\"PAYMENT_REQ_NO\":null,\"CUST_MGR_ID\":null}}"+
            //        "{\"table\":\"OGGTOPIC.SIMPLE_ORDER\",\"op_type\":\"I\",\"op_ts\":\"2016-12-06 02:04:14.980615\",\"current_ts\":\"2016-12-06T10:04:16.354002\",\"pos\":\"00000000160056477278\",\"after\":{\"ORDER_ID\":\"100391497\",\"ESC_ORDERID\":\"9020161206391497\",\"SELLER_ONLYID\":\"1200002\",\"SELLER_LOGINID\":\"���������������������������\",\"BUYER_ONLYID\":\"663\",\"BUYER_LOGINID\":\"���������������\",\"PRODUCT_SERIAL\":null,\"PRODUCT_ID\":null,\"PRODUCT_VERSION\":1,\"PRODUCT_CLASSID\":\"1\",\"PRODUCT_INFO\":\"������\",\"PRODUCT_PIC\":\"99887766\",\"PRODUCT_PRICE\":\"1\",\"PRODUCT_NUM\":null,\"PRODUCT_AMOUNT\":\"1\",\"PRODUCT_POINT_STATUS\":null,\"PRODUCT_COUPON_STATUS\":null,\"TRADE_DESC\":null,\"TRANS_TYPE1_VALUE\":null,\"TRANS_TYPE1_ADDVALUE\":null,\"TRANS_TYPE1_AMOUNT\":null,\"TRANS_TYPE2_VALUE\":null,\"TRANS_TYPE2_ADDVALUE\":null,\"TRANS_TYPE2_AMOUNT\":null,\"TRANS_TYPE3_VALUE\":null,\"TRANS_TYPE3_ADDVALUE\":null,\"TRANS_TYPE3_AMOUNT\":null,\"TRANS_TYPE4_VALUE\":null,\"TRANS_TYPE4_ADDVALUE\":null,\"TRANS_TYPE4_AMOUNT\":null,\"TRANS_TYPE5_VALUE\":null,\"TRANS_TYPE5_ADDVALUE\":null,\"TRANS_TYPE5_AMOUNT\":null,\"TRANS_TYPE6_VALUE\":null,\"TRANS_TYPE6_ADDVALUE\":null,\"TRANS_TYPE6_AMOUNT\":null,\"TRANS_TYPE7_VALUE\":null,\"TRANS_TYPE7_ADDVALUE\":null,\"TRANS_TYPE7_AMOUNT\":null,\"SALE_TYPE\":null,\"BUY_TYPE\":null,\"COUPON_ID\":null,\"COUPON_AMOUNT\":null,\"COUPON_USE_TIME\":null,\"TRANS_TYPE\":null,\"TRANS_SUBTYPE\":null,\"TRANS_CONTACT\":null,\"TRANS_INFO\":null,\"TRANS_ADDRESS\":null,\"TRANS_POSTAL_CODE\":null,\"TRANS_COUNTRY\":null,\"TRANS_PROVINCE\":\"������\",\"TRANS_CITY\":\"���������\",\"TRANS_USR_NAME\":null,\"TRANS_USR_PHONE\":null,\"TRANS_AMOUNT\":null,\"REBATE_AMOUNT\":null,\"GROUPBUY_AMOUNT\":null,\"ORDER_AMOUNT\":\"1\",\"PAYMENT_AMOUNT\":\"0\",\"REFUND_AMOUNT\":null,\"RELEASE_AMOUNT\":null,\"ORDER_PAYMENTID\":null,\"ORDER_REFUNDID\":null,\"ORDER_CREATE_TIME\":\"2016-12-06:10:04:14\",\"BANKPAY_ACTIVE_TIME\":null,\"POSTPAY_ACTIVE_TIME\":null,\"SELLER_MODIFY_TIME\":null,\"BUYER_MODIFY_TIME\":null,\"BUYER_REQUEST_TIME\":null,\"SELLER_RESPOND_TIME\":null,\"BUYER_PAY_TIME\":null,\"BUYER_RELEASE_TIME\":null,\"SELLER_SHIP_TIME\":null,\"ORDER_TERMINAL_TIME\":null,\"ORDER_ACTIVE_TIME\":null,\"BUYER_REFUND_TIME\":null,\"REFUND_ACTIVE_TIME\":null,\"ORDER_DELETED\":null,\"BUYER_FEEDBACK\":null,\"BUYER_FEEDBACK_TIME\":null,\"SELLER_FEEDBACK\":null,\"SELLER_FEEDBACK_TIME\":null,\"ORDER_STATUS\":3,\"ORDER_SUBSTATUS\":0,\"BUYER_NOTE\":null,\"BUYER_NOTE_TIME\":null,\"SELLER_NOTE\":null,\"SELLER_NOTE_TIME\":null,\"CANCEL_TYPE\":null,\"CANCEL_NOTE\":null,\"CANCEL_TIME\":null,\"REQUEST_CS_STATUS\":null,\"REQUEST_CS_TIME\":null,\"FREEZE_STATUS\":null,\"FREEZE_START_TIME\":null,\"FREEZE_CANCEL_TIME\":null,\"PAYMENT_NOTIFY_EMAIL\":null,\"PAYMENT_CLOSE_EMAIL\":null,\"SHIPITEM_NOTIFY_EMAIL\":null,\"RELEASE_NOTIFY_EMAIL1\":null,\"RELEASE_NOTIFY_EMAIL2\":null,\"RELEASE_NOTIFY_EMAIL3\":null,\"UPDATE_TIME\":\"2016-12-06:10:04:14\",\"CREATE_SP_ID\":null,\"BUYER_IP_ADDR\":\"180.169.59.210\",\"BUYER_HD_ID\":null,\"BUYER_CPU_ID\":null,\"BUYER_MAC_ID\":null,\"BUYER_COOKIE_INFO\":null,\"SELLER_IP_ADDR\":null,\"SELLER_HD_ID\":null,\"SELLER_CPU_ID\":null,\"SELLER_MAC_ID\":null,\"SELLER_COOKIE_INFO\":null,\"TRANS_WEBSITE\":null,\"BUYER_NOTE2\":null,\"BUYER_NOTE2_TIME\":null,\"SELLER_NOTE2\":null,\"SELLER_NOTE2_TIME\":null,\"FEEDBACK_INVOKE_STATUS\":null,\"POINT_INVOKE_STATUS\":null,\"MERCHANT_ORDER\":null,\"MERCHANT_USR_NAME\":null,\"MERCHANT_USR_EMAIL\":null,\"MERCHANT_BACKURL\":\"http://checkout.beta.ule.com/simpleorder/jiaofei/donatesuccess.do?escOrderId=9020161206391497&orderType=5002\",\"MERCHANT_DATE\":null,\"MERCHANT_RESPOND_STATUS\":null,\"CHARGES_AMOUNT\":null,\"SEARCH_SITE\":null,\"PRD_CATEGORY\":null,\"PRD_ITEM_ID\":\"1102\",\"PRD_CURRENCY\":\"1\",\"PRD_SAL_PRICE\":null,\"PRD_SAL_SHIPPING_FEE\":null,\"PARTNER_STATUS\":null,\"PARTNER_CONFIRM_TIME\":null,\"PARTNER_CONFIRM_NOTE\":null,\"PARTNER_PURCHASE_TIME\":null,\"PARTNER_PURCHASE_NOTE\":null,\"PARTNER_SHIPPING_TIME\":null,\"PARTNER_SHIPPING_NOTE\":null,\"INVOICE_TITLE\":null,\"INVOICE_CONTENT\":null,\"ORDER_TYPE\":\"5002\",\"CHECKOUT_MERCHANT_PRIVS_ID\":null,\"MERCHANT_ID\":null,\"INVOICE_IN_USE\":null,\"DELIVER_TIME\":null,\"DELIVER_CONFIM_FLAG\":null,\"POSTOFFICE_ID\":null,\"POSTOFFICE_NAME\":null,\"PAYED_AMOUNT\":null,\"AREA\":null,\"TEL_NUMBER\":null,\"TEL_AREA_CODE\":null,\"COST_PRICE\":null,\"REFER_TRANS_AMOUNT\":null,\"ACTUAL_TRANS_AMOUNT\":null,\"USEDPOINT\":null,\"USEDPOINTTYPE\":null,\"COUPONTYPE\":null,\"USEDPOINTAMOUNT\":null,\"RESERVE_FLAG\":null,\"PAYMENT_START_TIME\":null,\"POINT_NAME\":null,\"POINT_WEBSITE\":null,\"REMARK\":null,\"EXTRA_RECEIVE_INVOICE\":null,\"INVOICE_NAME\":null,\"INVOICE_TEL\":null,\"INVOICE_MOBILE\":null,\"INVOICE_ADDRESS\":null,\"INVOICE_POSTCODE\":null,\"BUYER_NAME\":null,\"BUYER_PHONE\":null,\"BUYER_MOBILE\":null,\"BUYER_EMAIL\":null,\"BUYER_POST_CODE\":null,\"BUYER_ADDRESS\":null,\"TRANS_PROVINCE_CODE\":\"310000\",\"TRANS_CITY_CODE\":\"310100\",\"AREA_CODE\":null,\"PROMOTION_TICKET\":null,\"SUPPORTED_BUYTYPE\":\"9_9:9_10:9_11:40_41:5_54\",\"DISCOUNT_AMOUNT\":null,\"PAYMENT_DUE_DATE\":null,\"CARD_CASH_PAY\":null,\"INVOICE_REQUIRED\":null,\"INVOICE_TYPE2\":null,\"INVOICE_BY_DETAIL\":null,\"INVOICE_TAX_COMPANY\":null,\"INVOICE_TAX_REG_NO\":null,\"INVOICE_TAX_REG_ADDR\":null,\"INVOICE_TAX_REG_TEL\":null,\"INVOICE_TAX_REG_BANK\":null,\"INVOICE_TAX_REG_ACC\":null,\"INVOICE_ISSUE_STATUS\":null,\"INVOICE_REISSUE_TIMES\":null,\"INVOICE_REISSUE_TIME\":null,\"INVOICE_DUP_ISSUE_TIMES\":null,\"INVOICE_DUP_ISSUE_TIME\":null,\"INVOICE_STATUS_LOCKED\":null,\"INVOICE_STATUS_LOCKED_TIME\":null,\"INVOICE_TYPE\":null,\"INVOICE_POST_TYPE\":null,\"SERVICE_FEE\":null,\"UPDATE_BY\":null,\"BUY_SUBTYPE\":null,\"CHANNEL\":\"ONLINE\",\"LIST_NUMBER\":null,\"SALES_CHANNEL\":\"101\",\"SELLER_NOTE3\":\"���������������������\",\"SELLER_NOTE4\":\"46967\",\"SELLER_NOTE5\":null,\"SELLER_NOTE6\":null,\"ID\":null,\"ORDER_POINT\":null,\"UNIQUE_KEY\":null,\"SETTLEMENT_FLAG\":null,\"BUYER_PROVINCE\":null,\"BUYER_PROVINCE_CODE\":null,\"BUYER_CITY\":null,\"BUYER_CITY_CODE\":null,\"BUYER_AREA\":null,\"BUYER_AREA_CODE\":null,\"SELLER_PROVINCE\":null,\"SELLER_PROVINCE_CODE\":null,\"SELLER_CITY\":null,\"SELLER_CITY_CODE\":null,\"SELLER_AREA\":null,\"SELLER_AREA_CODE\":null,\"PAYMENT_REQ_NO\":null,\"CUST_MGR_ID\":null}}"+
            //        "{\"table\":\"OGGTOPIC.SIMPLE_ORDER\",\"op_type\":\"I\",\"op_ts\":\"2016-12-06 02:04:14.980616\",\"current_ts\":\"2016-12-06T10:04:16.354003\",\"pos\":\"00000000160056477278\",\"after\":{\"ORDER_ID\":\"100391497\",\"ESC_ORDERID\":\"9020161206391497\",\"SELLER_ONLYID\":\"1200002\",\"SELLER_LOGINID\":\"���������������������������\",\"BUYER_ONLYID\":\"663\",\"BUYER_LOGINID\":\"���������������\",\"PRODUCT_SERIAL\":null,\"PRODUCT_ID\":null,\"PRODUCT_VERSION\":1,\"PRODUCT_CLASSID\":\"1\",\"PRODUCT_INFO\":\"������\",\"PRODUCT_PIC\":\"99887766\",\"PRODUCT_PRICE\":\"1\",\"PRODUCT_NUM\":null,\"PRODUCT_AMOUNT\":\"1\",\"PRODUCT_POINT_STATUS\":null,\"PRODUCT_COUPON_STATUS\":null,\"TRADE_DESC\":null,\"TRANS_TYPE1_VALUE\":null,\"TRANS_TYPE1_ADDVALUE\":null,\"TRANS_TYPE1_AMOUNT\":null,\"TRANS_TYPE2_VALUE\":null,\"TRANS_TYPE2_ADDVALUE\":null,\"TRANS_TYPE2_AMOUNT\":null,\"TRANS_TYPE3_VALUE\":null,\"TRANS_TYPE3_ADDVALUE\":null,\"TRANS_TYPE3_AMOUNT\":null,\"TRANS_TYPE4_VALUE\":null,\"TRANS_TYPE4_ADDVALUE\":null,\"TRANS_TYPE4_AMOUNT\":null,\"TRANS_TYPE5_VALUE\":null,\"TRANS_TYPE5_ADDVALUE\":null,\"TRANS_TYPE5_AMOUNT\":null,\"TRANS_TYPE6_VALUE\":null,\"TRANS_TYPE6_ADDVALUE\":null,\"TRANS_TYPE6_AMOUNT\":null,\"TRANS_TYPE7_VALUE\":null,\"TRANS_TYPE7_ADDVALUE\":null,\"TRANS_TYPE7_AMOUNT\":null,\"SALE_TYPE\":null,\"BUY_TYPE\":null,\"COUPON_ID\":null,\"COUPON_AMOUNT\":null,\"COUPON_USE_TIME\":null,\"TRANS_TYPE\":null,\"TRANS_SUBTYPE\":null,\"TRANS_CONTACT\":null,\"TRANS_INFO\":null,\"TRANS_ADDRESS\":null,\"TRANS_POSTAL_CODE\":null,\"TRANS_COUNTRY\":null,\"TRANS_PROVINCE\":\"������\",\"TRANS_CITY\":\"���������\",\"TRANS_USR_NAME\":null,\"TRANS_USR_PHONE\":null,\"TRANS_AMOUNT\":null,\"REBATE_AMOUNT\":null,\"GROUPBUY_AMOUNT\":null,\"ORDER_AMOUNT\":\"1\",\"PAYMENT_AMOUNT\":\"0\",\"REFUND_AMOUNT\":null,\"RELEASE_AMOUNT\":null,\"ORDER_PAYMENTID\":null,\"ORDER_REFUNDID\":null,\"ORDER_CREATE_TIME\":\"2016-12-06:10:04:14\",\"BANKPAY_ACTIVE_TIME\":null,\"POSTPAY_ACTIVE_TIME\":null,\"SELLER_MODIFY_TIME\":null,\"BUYER_MODIFY_TIME\":null,\"BUYER_REQUEST_TIME\":null,\"SELLER_RESPOND_TIME\":null,\"BUYER_PAY_TIME\":null,\"BUYER_RELEASE_TIME\":null,\"SELLER_SHIP_TIME\":null,\"ORDER_TERMINAL_TIME\":null,\"ORDER_ACTIVE_TIME\":null,\"BUYER_REFUND_TIME\":null,\"REFUND_ACTIVE_TIME\":null,\"ORDER_DELETED\":null,\"BUYER_FEEDBACK\":null,\"BUYER_FEEDBACK_TIME\":null,\"SELLER_FEEDBACK\":null,\"SELLER_FEEDBACK_TIME\":null,\"ORDER_STATUS\":3,\"ORDER_SUBSTATUS\":0,\"BUYER_NOTE\":null,\"BUYER_NOTE_TIME\":null,\"SELLER_NOTE\":null,\"SELLER_NOTE_TIME\":null,\"CANCEL_TYPE\":null,\"CANCEL_NOTE\":null,\"CANCEL_TIME\":null,\"REQUEST_CS_STATUS\":null,\"REQUEST_CS_TIME\":null,\"FREEZE_STATUS\":null,\"FREEZE_START_TIME\":null,\"FREEZE_CANCEL_TIME\":null,\"PAYMENT_NOTIFY_EMAIL\":null,\"PAYMENT_CLOSE_EMAIL\":null,\"SHIPITEM_NOTIFY_EMAIL\":null,\"RELEASE_NOTIFY_EMAIL1\":null,\"RELEASE_NOTIFY_EMAIL2\":null,\"RELEASE_NOTIFY_EMAIL3\":null,\"UPDATE_TIME\":\"2016-12-06:10:04:14\",\"CREATE_SP_ID\":null,\"BUYER_IP_ADDR\":\"180.169.59.210\",\"BUYER_HD_ID\":null,\"BUYER_CPU_ID\":null,\"BUYER_MAC_ID\":null,\"BUYER_COOKIE_INFO\":null,\"SELLER_IP_ADDR\":null,\"SELLER_HD_ID\":null,\"SELLER_CPU_ID\":null,\"SELLER_MAC_ID\":null,\"SELLER_COOKIE_INFO\":null,\"TRANS_WEBSITE\":null,\"BUYER_NOTE2\":null,\"BUYER_NOTE2_TIME\":null,\"SELLER_NOTE2\":null,\"SELLER_NOTE2_TIME\":null,\"FEEDBACK_INVOKE_STATUS\":null,\"POINT_INVOKE_STATUS\":null,\"MERCHANT_ORDER\":null,\"MERCHANT_USR_NAME\":null,\"MERCHANT_USR_EMAIL\":null,\"MERCHANT_BACKURL\":\"http://checkout.beta.ule.com/simpleorder/jiaofei/donatesuccess.do?escOrderId=9020161206391497&orderType=5002\",\"MERCHANT_DATE\":null,\"MERCHANT_RESPOND_STATUS\":null,\"CHARGES_AMOUNT\":null,\"SEARCH_SITE\":null,\"PRD_CATEGORY\":null,\"PRD_ITEM_ID\":\"1102\",\"PRD_CURRENCY\":\"1\",\"PRD_SAL_PRICE\":null,\"PRD_SAL_SHIPPING_FEE\":null,\"PARTNER_STATUS\":null,\"PARTNER_CONFIRM_TIME\":null,\"PARTNER_CONFIRM_NOTE\":null,\"PARTNER_PURCHASE_TIME\":null,\"PARTNER_PURCHASE_NOTE\":null,\"PARTNER_SHIPPING_TIME\":null,\"PARTNER_SHIPPING_NOTE\":null,\"INVOICE_TITLE\":null,\"INVOICE_CONTENT\":null,\"ORDER_TYPE\":\"5002\",\"CHECKOUT_MERCHANT_PRIVS_ID\":null,\"MERCHANT_ID\":null,\"INVOICE_IN_USE\":null,\"DELIVER_TIME\":null,\"DELIVER_CONFIM_FLAG\":null,\"POSTOFFICE_ID\":null,\"POSTOFFICE_NAME\":null,\"PAYED_AMOUNT\":null,\"AREA\":null,\"TEL_NUMBER\":null,\"TEL_AREA_CODE\":null,\"COST_PRICE\":null,\"REFER_TRANS_AMOUNT\":null,\"ACTUAL_TRANS_AMOUNT\":null,\"USEDPOINT\":null,\"USEDPOINTTYPE\":null,\"COUPONTYPE\":null,\"USEDPOINTAMOUNT\":null,\"RESERVE_FLAG\":null,\"PAYMENT_START_TIME\":null,\"POINT_NAME\":null,\"POINT_WEBSITE\":null,\"REMARK\":null,\"EXTRA_RECEIVE_INVOICE\":null,\"INVOICE_NAME\":null,\"INVOICE_TEL\":null,\"INVOICE_MOBILE\":null,\"INVOICE_ADDRESS\":null,\"INVOICE_POSTCODE\":null,\"BUYER_NAME\":null,\"BUYER_PHONE\":null,\"BUYER_MOBILE\":null,\"BUYER_EMAIL\":null,\"BUYER_POST_CODE\":null,\"BUYER_ADDRESS\":null,\"TRANS_PROVINCE_CODE\":\"310000\",\"TRANS_CITY_CODE\":\"310100\",\"AREA_CODE\":null,\"PROMOTION_TICKET\":null,\"SUPPORTED_BUYTYPE\":\"9_9:9_10:9_11:40_41:5_54\",\"DISCOUNT_AMOUNT\":null,\"PAYMENT_DUE_DATE\":null,\"CARD_CASH_PAY\":null,\"INVOICE_REQUIRED\":null,\"INVOICE_TYPE2\":null,\"INVOICE_BY_DETAIL\":null,\"INVOICE_TAX_COMPANY\":null,\"INVOICE_TAX_REG_NO\":null,\"INVOICE_TAX_REG_ADDR\":null,\"INVOICE_TAX_REG_TEL\":null,\"INVOICE_TAX_REG_BANK\":null,\"INVOICE_TAX_REG_ACC\":null,\"INVOICE_ISSUE_STATUS\":null,\"INVOICE_REISSUE_TIMES\":null,\"INVOICE_REISSUE_TIME\":null,\"INVOICE_DUP_ISSUE_TIMES\":null,\"INVOICE_DUP_ISSUE_TIME\":null,\"INVOICE_STATUS_LOCKED\":null,\"INVOICE_STATUS_LOCKED_TIME\":null,\"INVOICE_TYPE\":null,\"INVOICE_POST_TYPE\":null,\"SERVICE_FEE\":null,\"UPDATE_BY\":null,\"BUY_SUBTYPE\":null,\"CHANNEL\":\"ONLINE\",\"LIST_NUMBER\":null,\"SALES_CHANNEL\":\"101\",\"SELLER_NOTE3\":\"���������������������\",\"SELLER_NOTE4\":\"46967\",\"SELLER_NOTE5\":null,\"SELLER_NOTE6\":null,\"ID\":null,\"ORDER_POINT\":null,\"UNIQUE_KEY\":null,\"SETTLEMENT_FLAG\":null,\"BUYER_PROVINCE\":null,\"BUYER_PROVINCE_CODE\":null,\"BUYER_CITY\":null,\"BUYER_CITY_CODE\":null,\"BUYER_AREA\":null,\"BUYER_AREA_CODE\":null,\"SELLER_PROVINCE\":null,\"SELLER_PROVINCE_CODE\":null,\"SELLER_CITY\":null,\"SELLER_CITY_CODE\":null,\"SELLER_AREA\":null,\"SELLER_AREA_CODE\":null,\"PAYMENT_REQ_NO\":null,\"CUST_MGR_ID\":null}}";

           String message = "{\"table\":\"OGGTOPIC.new_core_bdfmhqab\",\"op_type\":\"I\",\"op_ts\":\"2016-12-06 02:04:14.980614\",\"current_ts\":\"2016-12-06T10:04:16.354001\",\"pos\":\"00000000160056477278\",\"after\":{\"AB01AC15\":101000015869842,\"AB02CCYC\":CNY,\"AB03CHSX\":1,\"AB16BAL\":55555.55}}";
           String message1 = "{\"table\":\"OGGTOPIC.new_core_bdfmhqab\",\"op_type\":\"U\",\"op_ts\":\"2016-12-06 02:04:14.980614\",\"current_ts\":\"2016-12-06T10:04:16.354001\",\"pos\":\"00000000160056477278\",\"after\":{\"AB01AC15\":101000015869842,\"AB02CCYC\":CNY,\"AB03CHSX\":1,\"AB16BAL\":66666.66}}";
           String message2 = "{\"table\":\"OGGTOPIC.new_core_bdfmhqab1\",\"op_type\":\"I\",\"op_ts\":\"2016-12-06 02:04:14.980614\",\"current_ts\":\"2016-12-06T10:04:16.354001\",\"pos\":\"00000000160056477278\",\"after\":{\"AB01AC15\":101000015869842,\"AB02CCYC\":CNY,\"AB03CHSX\":1,\"AB16BAL\":55555.55}}";
          
           message = message2+message+message1;
           
           List<String> skipedMessageNames = new ArrayList<>();
          // MessageProcessor processor = new MessageProcessor(dataService,organizationId,repositoryId,sourceApplicationId,"ogg","testdb",skipedMessageNames,clientNodeId);

           //processor.processMessage(null,1,"topic",message,null);
        }
        catch(Throwable e)
        {
            System.out.println("execute failed! e="+e);
            //Tool.SleepAWhile(1, 0);
        }
 
    }
        
     
}
